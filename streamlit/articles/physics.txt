--- Page 1 ---
arXiv:2410.18947v1  [hep-lat]  24 Oct 2024 Internal structure of gauge-invariant Projected Entangled Pair States David Blanik,1 Jos´e Garre-Rubio,2, 3 Andr´as Moln´ar,2 and Erez Zohar4 1University of Vienna, Faculty of Physics, Boltzmanngasse 5, 1090 Vienna, Austria 2University of Vienna, Faculty of Mathematics, Oskar-Morgenstern-Platz 1, 1090 Vienna, Austria 3Instituto de F´ısica Te´orica, UAM/CSIC, Universidad Aut´onoma de Madrid, Madrid, Spain 4Racah Institute of Physics, The Hebrew University of Jerusalem, Givat Ram, Jerusalem 91904, Israel (Dated: October 25, 2024) Projected entangled pair states (PEPS) are very useful in the description of strongly correlated systems, partly because they allow encoding symmetries, either global or local (gauge), naturally. In recent years, PEPS with local symmetries have increasingly been used in the study of non- perturbative regimes of lattice gauge theories, most prominently as a way to construct variational ansatz states depending only on a small number of parameters and yet capturing the relevant physical properties. For the case of one-dimensional PEPS (Matrix Product States — MPS) a bidirectional connection was established between the internal structure of the tensor network, i.e. the mathematical properties of the constituent tensors, and the symmetry. In higher dimensions this has only been done for global symmetries, where in the local (gauge) case it is known only how to construct gauge-invariant states, but not what the symmetry implies on the internal structure of the PEPS. In the present work we complete this missing piece and study the internal structure of projected entangled pair states with a gauge symmetry. The PEPS we consider consist of matter and gauge ﬁeld tensors placed on the vertices and edges, respectively, of arbitrary graphs. I. INTRODUCTION The role of gauge theories in modern physics cannot be underestimated. Having local symmetries at their core, they describe matter minimally coupled to gauge ﬁelds acting as interaction mediators. This quantum ﬁeld the- oretic description [1] is central to the Standard Model of particle physics [2], as well as several eﬀective models of condensed matter [3]. However, quantum gauge ﬁeld theories, particularly non-abelian ones, are notoriously diﬃcult to study in their non-perturbative regimes. One successful approach involves the latticization of the theory, as proposed by Wilson [4], which, when combined with Monte Carlo techniques [5], allows the computation of many important static quantities; for example, the hadronic spectrum of quantum chromodynamics (see, e.g., the review [6]). This approach, however, faces signiﬁcant challenges when dealing with two speciﬁc, physically important scenar- ios. First, it does not allow the direct description of real-time evolution, since Monte Carlo computations are performed within a Euclidean, Wick-rotated spacetime. Second, at ﬁnite fermion density, the sign problem [7] may occur, blocking the way for Monte-Carlo studies of exotic phases, including many physically relevant regions of the QCD phase diagram [8]. One relatively recent way of tackling these issues, and in particular overcoming the sign problem, which is spe- ciﬁc to path-integral Monte Carlo computations, is the use of tensor network states. Tensor network states (TNS) [9–12] are constructed from local tensors placed at particle sites (usually vertices or edges of the lattice) mimicking the interactions between them. The size of these local tensors determines how well the TNS approx- imates a given state. Crucially, TNS constructed from lo- cal tensors of only moderate size are already well suited to approximate states satisfying an entanglement area law, expected to hold for physically relevant states (e.g., ground states of local gapped Hamiltonians [13–16]), al- lowing for eﬃcient numerical computations. In the con- text of lattice gauge theories, two (and higher) dimen- sional tensor networks, and in particular projected en- tangled pair states (PEPS) [12, 17], have been applied to the Hamiltonian formulation, introduced by Kogut and Susskind [18]. In one space dimension, the family of TNS known as matrix product states (MPS) have been suc- cessfully applied to several lattice gauge theory models (see, e.g., the earlier works [19–25] as well as the review papers [26–28]). In higher dimensions, either tree tensor networks or inﬁnite PEPS are used [29–37] — both are very powerful numerical techniques, though not necessar- ily tailored to the symmetries present in such models. A parallel, non-Hamiltonian approach is that of the Tensor Renormalization Group (TRG) method, as described in detail in the review [38]. Other approaches are based on the gauging of globally symmetric PEPS [39, 40], where one lifts the global sym- metry to a local one, creating ansatz states useful for lat- tice gauge theory computations. In particular, [40] sug- gested how this can be done in a way analogous to min- imal coupling of free, globally invariant matter Hamilto- nians or Lagrangians [1], where the lift is achieved by the introduction of gauge ﬁelds. It was shown that when the gauged state is a Gaussian fermionic PEPS [41], giving rise to states known as gauged Gaussian PEPS [42, 43], one can use variational Monte Carlo techniques for an eﬃcient ground state search [44–47]. Therefore such gauged PEPS are useful in physical contexts and could be utilized in the study of the non-perturbative regime of lattice gauge theories. While the above works do well in providing methods to construct PEPS with gauge sym- metries, one would like to understand the reverse direc- 

--- Page 2 ---
2 tion as well — given a locally symmetric PEPS, how is the symmetry encoded in its local constituents? The way global properties of TNS, e.g., symmetries, are encoded in the local tensors is of high relevance to the study of such states (e.g., leading to the classiﬁcation of 1D gapped phases [48, 49]). This question has previously been addressed for a sin- gle space dimension, that is, for MPS [50], and in the present work we aim at extending their results to higher dimensions, arbitrary lattices, geometries or graphs. For several families of TNS, the local encoding of the sym- metry can be extracted using a set of results known as Fundamental Theorems [51], however, fundamental ob- structions [52] prevent a fully general analysis. Conse- quently, in this work we shall only consider PEPS with matter and gauge ﬁelds described by local tensors which become injective after blocking, a strong invertibility con- dition [11, 51]. This family is important because an in- jective PEPS with only matter degrees of freedom is the unique ground state of an associated local, gapped Hamil- tonian [53], known as the parent Hamiltonian. The structure of the paper is as follows. We begin in Section II by introducing the necessary background on tensor network states and their graphical notation. Then in Section III we analyze the very simplest non-trivial example of a PEPS on the square lattice. This section only serves to illustrate the main ideas of our method in a simple setting. In Section IV we state and prove our main technical lemma, a slightly stronger variation of the Fundamental Theorem of injective MPS, established in [51]. Finally, in Section V we state and prove our results in the most general setting we have been able to analyze. II. BASICS ON TENSOR NETWORKS AND GRAPHICAL NOTATION Tensor network states are constructed via the con- catenation of local tensors, often placed on the vertices and/or edges of a regular lattice. We explain the key concepts of this construction on the very important ex- ample of matrix product states (MPS) in the setting of spin chains [11]. A (translation invariant) MPS is deﬁned by a 3-index tensor B where one index corresponds to the local Hilbert space Cd and the other two are associated with the so-called virtual or auxiliary level with bond di- mension D. The tensor B can be seen as a collection of d matrices, each of size D × D: {Bi, i = 1, . . . , d}. Then the MPS on n sites constructed with the tensor B is given by: |Ψ(B)⟩n = X i1,...,in Tr  Bi1 · · · Bin	 |i1, . . . , in⟩. (1) From a slightly more abstract point of view, which we shall adopt below, one considers the MPS tensor B to be an element of the tensor product of the physical and vir- tual Hilbert spaces, which will also be deﬁned below. The importance of this class of TNS stems from the ability of MPS to eﬃciently approximate ground states of local, gapped Hamiltonians, which follows from the fact that both satisfy an entanglement entropy area law [13, 14]. In order to generalize this construction to higher di- mensions we will ﬁrst introduce the graphical notation of tensors. A tensor is depicted by a shape, usually a circle, with as many legs as indices, where the indices should be thought of as corresponding to a choice of ba- sis on the Hilbert space associated with the leg. There are two basic operations between the indices of (diﬀerent) tensors. The ﬁrst one is the contraction of two indices where the labels are identiﬁed and summed over. An example is matrix multiplication: (fg)ij = P kl δklfikglj. The graphical representation of the contraction is to glue or concatenate the legs of the involved indices together. This operation corresponds to the natural pairing be- tween a Hilbert space and its dual and can in some cases be viewed as composition of functions, c.f. Figure 1(b). The second operation is blocking: here multiple indices, or Hilbert spaces, are considered as one, so that their to- tal dimension is the product of the individual ones. An example is the tensor product of matrices or operators, f ⊗g, c.f. Figure 1(a). The higher-dimensional general- ization of MPS are called projected entangled pair states (PEPS). For the two-dimensional square lattice the ten- sors of a PEPS are rank 5 (5 indices) and they are placed on the vertices, c.f. Figure 1(c, d). Notice the simplic- ity of the graphical notation; the corresponding algebraic expression is too complicated to be written down here. (a) f ⊗g ≡ f g (b) f ◦g ≡ f g (c) A = A (e) B = B (d) (f) · · · Figure 1. In graphical notation the tensor product (a) of operators is depicted by simply drawing the factors next to each other. Composition (b), or more generally contraction, is depicted as concatenation of diagrams, where the ordering is determined by the orientation of the legs. We depict a rank 5 tensor (c) and how it can be used to construct a PEPS on a square lattice (d), given the virtual Hilbert spaces are cho- sen appropriately. Similarly, a rank 3 tensor (e) can be used to construct a translation invariant MPS (f) with periodic boundary conditions. Deﬁnition II.1 (MPS). Formally, in TN diagrams a Hilbert space is assigned to each edge (or leg) and ten- sors, being nodes where multiple edges meet, are simply elements in the tensor product of the Hilbert spaces as- 

--- Page 3 ---
3 sociated with its incident legs, e.g., B ≡ B ≡ B H Vo Vt ∈Vo ⊗H ⊗V∗ t , (2) where the dual of a Hilbert space appears in the tensor product, if the edge it is associated with terminates at the tensor. Hilbert spaces denoted as H we shall refer to as phys- ical, while Hilbert spaces denoted as V we shall refer to as virtual. Equation (2) depicts the prototypical example of an MPS tensor, where we denote the virtual Hilbert spaces Vo and Vt, because they are associated with edges that have the MPS tensor as their origin and terminus, respectively. Deﬁnition II.2 (Injectivity). An MPS tensor B, deﬁned according to Equation (2), is called (i) injective, if it is injective as a map1 B : V∗ o ⊗Vt −→H. (3) (ii) left injective, if it is injective as a map B : Vt −→Vo ⊗H. (4) (iii) right injective, if it is injective as a map B : V∗ o −→H ⊗V∗ t . (5) (iv) unital, if Vo = Vt =: V and there exists x ∈H∗ such that B x = idV . (6) If a tensor satisﬁes (ii) and (iii), we call it LRI. In com- ponents, unitality just means P i xiBi = 1. Remark. Injective ⇒unital ⇒LRI. Part (i) of the previous deﬁnition is standard [11] and Lemma II.1 justiﬁes the introduction of notions (ii) and (iii). Part (iv) is convenient to give examples. Clearly, 1 When interpreting TN drawings as linear maps, we shall usually view them as going from bottom to top. injectivity of the tensor B is equivalent to the existence of a tensor B−1, often called the inverse of B, satisfying B B−1 = ≡idV∗ o ⊗idVt, (7) where in the last equality we view the TN diagram as a linear map going from bottom to top. Lemma II.1. Let T be an injective2 tensor. For any MPS tensor B the following equivalences hold: T B injective ⇔ B is left injective, (8) T B injective ⇔ B is right injective. (9) Proof. To prove (8, ⇒), assume B is not left injective, which implies the existence of x ∈Vt such that B x = 0, (10) which is of course in contradiction to the injectivity of the composite tensor. The reverse implication (8, ⇐) follows immediately after contracting the composite ten- sor with the inverse of T . One proves (9) in a completely analogous manner. Hence, blocking with B preserves injectivity precisely if it is left and/or right injective. III. EXAMPLE: NORMAL PEPS ON SQUARE LATTICE As a simple ﬁrst example, to illustrate the ideas ap- pearing in the proof of the general statement in Sec- tion V, we consider a gauge-invariant PEPS on a square lattice with periodic boundary conditions, i.e. deﬁned on the underlying geometry of a torus. Such a state is constructed by placing rank 5 tensors Av, which we think of as describing the matter degrees of freedom, at each vertex v and rank 3 tensors Be, which we think of as describing the gauge degrees of freedom, at each edge e of the lattice. The physical local Hilbert spaces, always associated with the ﬁrst leg of each tensor, are denoted Hv and He, respectively. 2 A PEPS tensor is called injective if it is injective as a map from virtual to physical Hilbert spaces, c.f. Deﬁnition V.4. 

--- Page 4 ---
4 (a) A A A A B B B B Ug Rg Lg Lg Rg (b) e0 Λt Λo Λj Λj (c) v0 e2 e′ 1 e1 e′ 2 Λt 2 Λo 1 Λo 2 Λt 1 Figure 2. (a) The tensors of the PEPS are placed on the square lattice. The A tensors reside on the vertices (sites), while the B tensors reside on the edges (links). The gauge symmetry acts, indicated by the shaded regions, on a vertex and on its surrounding edges. (b) Isolating a single gauge tensor B at edge e0 from the rest of the tensor network is achieved by selecting adjacent regions Λo and Λt, as indicated in the ﬁgure, in such a way that blocking the tensors contained within results in injective tensors. The region Λj contains the remainder of the lattice and can either be connected or disconnected. It is used only for bookkeeping purposes. The superscripts are meant to reference origin, terminus and junk, respectively, and we use the colors orange, teal and jade as a visual aid. When we don’t explicitly indicate the orientation of the edges in drawings, they are usually implied to be oriented left to right and bottom to top. (c) To separate a single matter tensor A at vertex v0 together with its surrounding gauge tensors, from the remaining tensor network we can employ the same regions we used above when isolating the edge tensors incident to v0, since blocking the tensors contained within Λt 1 ∪Λt 2 ∪Λo 1 ∪Λo 2, results in an injective tensor. Contracting the remaining legs, corresponding to vir- tual degrees of freedom, according to the lattice geometry depicted in Figure 2(a), results in the state: |Ψ(A, B)⟩∈ O v Hv ⊗ O e He. (11) Let G be a ﬁnite, or compact Lie group and con- sider representations3 Uv : G →GL(Hv) and Le, Re : G →GL(He), for all vertices (sites) v and edges (links) e, where we require L and R to be commuting, i.e. [Re(h), Le(g)] = 0 for all edges e and g, h ∈G. Saying the state |Ψ(A, B)⟩has a gauge symmetry simply means that (disregarding the case of static charges) it satisﬁes bUv(g) |Ψ(A, B)⟩= |Ψ(A, B)⟩ (12) for all vertices v, with bUv := Rvl ⊗Rvt ⊗Uv ⊗Lvr ⊗Lvb, (13) where the subscripts denote the edges to the left, top, right and below of the vertex v, c.f. Figure 2 (a). To simplify notation, we shall assume that all vertex tensors and edge tensors are equal, to be precise Av ≡A and Be ≡B for all v and e. This restriction is by no means necessary, but there is simply no insight to be 3 Homomorphisms from G to the general linear group on the re- spective Hilbert space. gained from considering the general case here. Graphi- cally, we can depict property (12) for a single vertex as Rg Rg Lg Lg Ug = , (14) where we use dotted lines to indicate that the equality involves the whole tensor network and not just the in- dicated tensors. We want to understand how the gauge symmetry of the PEPS is realized at the virtual level of the constituent tensors A and B, similar to what has already been established for MPS [50]. Given the well known fundamental obstructions [52], we do not expect to be able to solve this problem in full generality, but some extra assumptions on the tensors are needed to make progress. For this example we shall impose the following (unnecessarily strong) conditions: (i) The vertex tensors become injective after blocking rectangular (say 2 × 2) regions, i.e. A is normal. (ii) The edge tensor B is unital, c.f. Deﬁnition II.2(iv). These conditions imply in particular that blocked tensors of the shape (15) 

--- Page 5 ---
5 are injective. When we prove the general statement we will see that we can weaken these conditions substan- tially. Continuing now with the above conditions on the PEPS tensors it is straightforward to derive their local transformation properties under the gauge symmetry, by focusing ﬁrst on the behavior of a single edge tensor. Fix an edge e0 and consider regions Λo, Λt and Λj, as indi- cated in Figure 2 (b), and let To, Tt and Tj, respectively, denote the tensors one gets after blocking the tensors in- side these regions. Clearly the PEPS can now be written as an MPS |Ψ(A, B)⟩= Be0 Tt To Tj Tj = To Be0 Tt Tj , where we do not draw the (many) physical legs of Tj. Notice that the blocked tensors To and Tt are of the form (15), hence injective, and that the gauge transformations involving e0 act either on To or Tt but never on both and never on Tj, so with slight abuse of notation we can write for all g ∈G To B Tt e U(g) L(g) Tj = To B Tt Tj , (16) where eU(g) ⊗L(g) := bU(g) and To B Tt R(g) e U(g) Tj = To B Tt Tj , (17) where R(g) ⊗eU(g) := bU(g). This means that the con- ditions of Lemma IV.1, to be stated and proved in the next section, are satisﬁed and we conclude the existence of unique, invertible matrices VL(g) and VR(g) such that B L(g) = B VL(g)−1 , B R(g) = B VR(g) , (18) for all g ∈G. Furthermore, from the uniqueness we conclude that VL and VR constitute representations of G. Having established how the tensor B transforms under L and R, only leaves the transformation property of the tensor A, which is remarkably simple to derive now. We shall again focus on a ﬁxed vertex v0. Notice that blocking the tensors contained in the regions Λo 1, Λo 2, Λt 1 and Λt 2, as indicated in Figure 2 (c), yields four injective tensors, which we can invert to decouple the vertex tensor A at v0 and its surrounding B tensors from the rest of the lattice. Knowing how the tensors B transform under the symmetry operations we can write Equation (14) as U = V −1 R V −1 R VL VL , (19) where we have suppressed the explicit g dependence. Now we invert the surrounding injective region as well as the surrounding edge tensors and, after discarding the rest of the lattice, are left with U(g) = VL(g) VL(g) VR(g)−1 VR(g)−1 , (20) for all g ∈G. Equations (18) and (20) can be recognised as the symmetry conditions of gauge-invariant PEPS, c.f. [40]. There, it was shown that these conditions guar- antee a construction of a gauge-invariant PEPS; here we prove the opposite direction. IV. MAIN TECHNICAL LEMMA In this section we prove a slightly stronger variation of the Fundamental Theorem of injective MPS [51]. We do so by generalizing the assumptions of the lemma to better apply to our speciﬁc situation. This lemma will be used to prove our general statement in section V. Lemma IV.1 (Fundamental Lemma). Let AL and AR be injective MPS tensors and X an arbitrary non-zero tensor, which may even include additional not contracted (usually physical) legs. If B is a right injective MPS tensor and the symmetry property AL B AR UL L X = AL B AR X (21) holds, where L and UL are invertible operators on the physical Hilbert spaces, then there exists a unique in- vertible matrix VL such that B L = B V −1 L . (22) Analogously, if B is a left injective MPS tensor and the symmetry property AL B AR R UR X = AL B AR X (23) 

--- Page 6 ---
6 holds, where R and UR are invertible operators on the physical Hilbert spaces, then there exists a unique in- vertible matrix VR such that B R = B VR . (24) Proof. We prove the statement for L and VL. The proof for R and VR is completely analogous. From Equa- tion (21) and the fact that AR is injective we conclude AL B L−1 X = AL B AR A−1 R UL X , (25) where the unlabeled tensor can be arbitrary. Since we required B to be left injective, the inverse of B AR is of the form C A−1 R , and Equation (25) implies AL X⊺ UL = AL VL X⊺ , VL := C B L−1 . (26) Inserting Equation (26) back into (21) gives AL B AR L X VL = AL B AR X (27) and after inverting the injective tensors AL and AR we are left with (recall X ̸= 0) B VL L = B . (28) Notice that by the right injectivity of B, the matrix VL satisfying Equation (28) has to be unique. What remains is to show that VL is invertible. By the same reasoning that led to Equation (28), but inverting UL instead of L in Equation (21), we get B V ′ L−1 = B , (29) for some matrix V ′. Combining Equations (28) and (29) with the right-injectivity of B yields VL V ′ = = V ′ VL , (30) i.e. V ′ is the inverse of VL. V. GENERAL STATEMENT A. PEPS construction In this section we give a general PEPS construction, where matter and gauge degrees of freedom are associ- ated with the vertices and edges, respectively, of an arbi- trary oriented graph. Throughout we use standard graph theory deﬁnitions and notation, c.f. [54], which we sum- marize in Appendix A. Deﬁnition V.1 (PEPS). Let Γ = (V, E) be an oriented4 graph with Hilbert spaces Hv and Ve assigned to every vertex v ∈V and edge e ∈E, respectively. We deﬁne a collection of PEPS tensors on Γ to be tensors Av ∈ O o∈Eov Vo ⊗Hv ⊗ O t∈Etv V∗ t (31) associated with each v ∈V . The corresponding state, simply referred to as PEPS, is deﬁned to be |ΨΓ(A)⟩:= trE O v∈V Av ∈ O v∈V Hv, (32) where we use trE to denote tensor contraction over all Hilbert spaces labeled by edges. The Hilbert spaces denoted by H are referred to as physical, while the Hilbert spaces denoted by V, intro- duced only for the purpose of constructing the PEPS, are referred to as virtual. As indicated by the notation, when we speak of a PEPS |ΨΓ(A)⟩, we have implicitly ﬁxed a collection of PEPS tensors giving rise to said state. Deﬁnition V.2 (Global symmetry). We say a PEPS |ΨΓ(A)⟩has a global symmetry, or is globally symmetric, with respect to given representations (Hv, Uv) ∈Rep G, for all v ∈vert Γ, if it satisﬁes O v∈Γ Uv(g) |ΨΓ(A)⟩= |ΨΓ(A)⟩, (33) for all g ∈G. Deﬁnition V.3 (Local symmetry). We say a PEPS |ΨΓ(A)⟩has a local symmetry, or is locally symmetric, with respect to given representations (Hv, Uv) ∈Rep G, for all v ∈vert Γ, if it satisﬁes Uv(g) |ΨΓ(A)⟩= |ΨΓ(A)⟩, (34) for all g ∈G and v ∈vert Γ. Clearly, the above deﬁnitions makes sense for any state in N v Hv, not just PEPS. We introduce these terms to explicitly distinguish them from gauge-invariant PEPS, which are introduced later. 4 A graph is said to be oriented if it has no double edges or loops and each edge is given an orientation. 

--- Page 7 ---
7 Deﬁnition V.4 (Blocking). Let |ΨΓ(A)⟩be a PEPS and Γ′ = (V ′, E′) ⊆Γ a subgraph. The tensor TΓ′(A) := trE′ O v∈V ′ Av, (35) where trE′ denotes tensor contraction over all Hilbert spaces labeled by edges in E′, is called blocked PEPS tensor along Γ′. The tensor TΓ′(A) is said to be injective if it is injective as a map O e∈∂oΓ′ V∗ e ⊗ O f∈∂iΓ′ V∗ f ⊗Vf ⊗ O d∈∂tΓ′ Vd −→ O v∈V ′ Hv, (36) where ∂tΓ′, ∂oΓ′ and ∂iΓ′ denote the terminal, original and internal boundaries5 of Γ′, respectively. In this con- text we will often say that Γ′ deﬁnes an injective region. Commonly one considers blocking along a full6 sub- graph, which simpliﬁes the injectivity condition on the blocked tensor, since full subgraphs have empty inter- nal boundary. Notice that for the special case where we choose a single vertex as the subgraph, the above notion of injectivity reduces to the usual one. Rephrasing [51, Lemma 4] in the language of PEPS de- ﬁned on oriented graphs gives the following useful lemma. Lemma V.1 (Union of injective regions is injective). Let |ΨΓ(A)⟩be a PEPS and Γ1, Γ2 ⊆Γ injective regions, i.e. the tensors TΓ1(A) and TΓ2(A) are injective. Then the union of the two subgraphs also deﬁnes an injective region, i.e. the blocked tensor TΓ1∪Γ2(A) is injective. Recall that in the example of Section III, we consid- ered a square lattice, where we assigned physical Hilbert spaces and rank 3 tensors also to the edges of the lat- tice, which is the accepted way to deﬁne gauge theories on a lattice. In our general setting of PEPS deﬁned on graphs, we only want to associate virtual Hilbert spaces with edges, hence it is most natural to introduce an addi- tional vertex at each edge, resulting in the bipartite graph Γb = (V, E, E), and carrying out the PEPS construction for Γb. Deﬁnition V.5 (gPEPS). The special case of a PEPS deﬁned on Γb = (V, E, E), the barycentric7 subdivision of the oriented graph Γ = (V, E), we call gPEPS on Γ. To reﬂect the bipartition of Γb we adopt slightly modiﬁed notation for the PEPS tensors Be ∈Vet ⊗He ⊗V∗ eo (37) 5 The terminal (original) boundary is comprised of all incoming (outgoing) edges, c.f. Deﬁnition A.6. 6 A full subgraph contains all edges in E connecting vertices in V ′, c.f. Deﬁnition A.5. 7 The barycentric subdivision is obtained by inserting an addi- tional vertex in the middle of each edge, resulting in the new set of edges E, c.f. Deﬁnition A.9. that are labeled by vertices in E, where eo and et, deﬁned in Equations (60), can be thought of as “half edges” of the original graph, and for the corresponding state |ΨΓ(A, B)⟩∈ O v∈V Hv ⊗ O e∈E He. (38) To wit, given a graph Γ = (V, E) we have associated to each vertex v ∈V a Hilbert space Hv, which we think of as describing matter degrees of freedom, and to each edge e ∈E a Hilbert space He, describing gauge degrees of freedom. We use the notation Hm := O v∈V Hv, Hg := O e∈E He, (39) for collectively referring to all matter (resp. gauge) de- grees of freedom. The general PEPS construction, ap- plied to Γb, then yields Av ∈ O o∈Eo v Vo ⊗Hv ⊗ O t∈Etv V∗ t , (40) Be ∈Vet ⊗He ⊗V∗ eo, (41) for each v ∈V and e ∈E. When comparing (41) with Equation (2), keep in mind that et originates at e while eo terminates at e. We will sometimes refer to the tensors A and B as vertex tensors and edge tensors, respectively. Deﬁnition V.6 (Gauge-invariant PEPS). A gPEPS |ΨΓ(A, B)⟩is said to be gauge-invariant, referred to as gauge-invariant PEPS below, with respect to given rep- resentations (Hv, Uv), (He, Le), (He, Re) ∈Rep G, for all v ∈V and e ∈E, if bUv(g) |ΨΓ(A, B)⟩= |ΨΓ(A, B)⟩, (42) for all g ∈G and v ∈V , where bUv := O e∈Eov Re ⊗Uv ⊗ O e∈Et v Le, (43) is called gauge operator centered at v. When we speak of a gauge-invariant PEPS |ΨΓ(A, B)⟩, we will often leave the deﬁning group representations im- plicit. B. Main theorem We prove that under mild assumptions the local ten- sors deﬁning a gauge-invariant PEPS have to satisfy in- tertwiner relations analogous to the ones encountered in the square lattice example. Deﬁnition V.7 (Invertible neighborhoods). Let |ΨΓ(A, B)⟩be a gauge-invariant PEPS. We say that 

--- Page 8 ---
8 e ∈edge Γ has invertible neighborhoods,8 if there are two disjoint subgraphs Λo, Λt ⊆Γb \ {e}, with o(e) ∈vert Λo and t(e) ∈ vert Λt, such that the blocked tensors TΛo(A, B) and TΛt(A, B) are injective. Theorem V.1. Let |ΨΓ(A, B)⟩be a gauge-invariant PEPS. If e ∈edge Γ has invertible neighborhoods, then there exist linear representations (Veo, Veo), (Vet, Vet) ∈ Rep G, such that the corresponding edge tensor Be sat- isﬁes the intertwiner relations Be Le(g) = Be V −1 et (g) , Be Re(g) = Be Veo (g) , (44) for all g ∈G. Proof. Without loss of generality we may assume that the subgraphs Λt and Λo, deﬁning the invertible neigh- borhoods, are full, connected and contain all vertices in Γb\{e} adjacent to t(e) and o(e), respectively. We sketch an example of the general situation in Figure 3. Let J denote the set of all vertices in Γb \ {e} not included in Λt or Λo and let Λj := Γb[J] ⊆Γb be the full subgraph induced by the set J. For brevity we drop the explicit dependence of the blocked tensors on the PEPS tensors from our notation. Let S be the set of edges in Γb not included in any of Λt, Λo or Λj, then we have |ΨΓ(A, B)⟩= trS (TΛt ⊗Be ⊗TΛo ⊗TΛj) = TΛt Be TΛo TΛj , (45) where we do not draw the (generally numerous) physical legs of TΛj. The blocked tensors TΛo and TΛt associ- ated with the invertible neighborhoods are injective by assumption and the symmetry properties bUt(e) |ΨΓ(A, B)⟩= bUo(e) |ΨΓ(A, B)⟩= |ΨΓ(A, B)⟩(46) translate to TΛt Be TΛo e Ut(g) Le(g) TΛj = TΛt Be TΛo TΛj , (47) where eUt(g) ⊗Le(g) := bUt(e)(g) and TΛt Be TΛo Re(g) e Uo(g) TΛj = TΛt Be TΛo TΛj , (48) 8 Not to be confused with the neighbourhood of a vertex, which has a diﬀerent meaning in graph theory. e0 x t(e0) o(e0) Λt Λo Λj Figure 3. It is convenient to think of the graph Γb as be- ing embedded in Euclidean space and label subgraphs by the spatial regions they are contained in. Since the edge tensors are all assumed to be LRI, whether the vertex x is seen as belonging to the orange or the teal region does not inﬂuence the injectivity of the blocked tensors associated with either subgraph. Only because the gauge operator centered at t(e0) will also act on the degrees of freedom associated with x are we forced to include it in the teal region. where Re(g) ⊗eUo(g) := bUo(e)(g), hence the Fundamental Lemma IV.1 gives the claimed intertwiner properties. Theorem V.2. Let |ΨΓ(A, B)⟩be a gauge-invariant PEPS on Γ = (V, E). If all edges of Γ, with vertex v ∈V as an endpoint, have invertible neighborhoods, then the vertex tensor Av will satisfy the intertwiner property Uv(g) ◦Av = Av ◦ O f∈Eov V −1 f o (g) ⊗ O e∈Etv Vet(g), (49) for all g ∈G, where {(V, V )} are the representations of Theorem V.1 and we view Av as a linear map Av : O f∈Eov V∗ f o ⊗ O e∈Etv Vet −→Hv. (50) Proof. By assumption, every e ∈E has invertible neigh- borhoods, which we shall respectively label Λt e and Λo e. Let v0 ∈V and use the invertible neighborhoods of the surrounding edges to construct the subgraph Λv0 := [ e∈Etv0 Λo e ∪ [ f∈Eov0 Λt f ⊆Γb. (51) According to Lemma V.1, the blocked tensor TΛv0 (A, B) is injective and since Λv0 contains all vertices adjacent to v0 in Γ, the condition bUv0(g) |ΨΓ(A, B)⟩= |ΨΓ(A, B)⟩ (52) 

--- Page 9 ---
9 v0 Λv0 Figure 4. We sketch a general example of how Λv0 looks like. While the individual invertible neighborhoods of the edges can be chosen to be full and connected, there is no reason why their union should remain to be so. Crucially, Λv0 contains all vertices adjacent to v0 as a vertex of Γ, but none as a vertex of Γb. is equivalent (by inverting TΛv0 and tracing out the re- maining degrees of freedom) to the equality Le1 (g) Le2 (g) Len(g) Rf1 (g) Rf2 (g) Rfm (g) Uv0 (g) v0 = v0 , (53) where Et v0 = {e1, . . . , en} and Eo v0 = {f1, . . . , fm}. After using Theorem V.1 to move the representations R and L to the virtual legs and inverting the edge tensors, which are assumed to be LRI, we are left with Uv0 (g) v0 = Vet 1 (g) Vet 2 (g) Vetn(g) Vfo 1 (g)−1 Vfo 2 (g)−1 Vfo m (g)−1 v0 . (54) Corollary V.1. Let |ΨΓ(A)⟩be a normal PEPS on a big enough graph Γ and Be be an arbitrary collection of unital edge tensors, such that the resulting gPEPS |ΨΓ(A, B)⟩is gauge-invariant. Then all vertex and edge tensors satisfy their appropriate intertwiner relations. Proof. Big enough means that the injective regions, which can be constructed for each edge by the normality of the vertex tensors, do not overlap and form injective neighborhoods in the sense of V.7. Then the conditions of Theorem V.2 are satisﬁed for every vertex and the intertwiner properties hold everywhere. Corollary V.2. Let |ψΓ(A)⟩be a normal PEPS with local onsite symmetry on a big enough graph Γ. Then the PEPS tensors Av transform trivially under the symmetry, i.e. Uv(g) ◦Av = Av, (55) for all g ∈G and v ∈vert Γ. Proof. The PEPS |ψΓ(A)⟩can be viewed as a gauge- invariant gPEPS |ψΓb(A, B = 1)⟩, with trivial edge ten- sors and Hilbert spaces. Since the edge tensors transform trivially, Theorem V.2 implies the same for the vertex tensors. VI. CONCLUSIONS AND OUTLOOK In this work we have analyzed the internal structure of tensor network states with a local (gauge) symmetry. The results derived here are valid for any dimension and geometry, and in particular for three space dimensional cubic lattices. The main technical assumptions of this work are the LRI property of the edge tensors and the invertibility condition, c.f. Deﬁnition V.7, imposed on all edges. How these conditions can be weakened, e.g., by using other notions of injectivity, like G-injectivity that in 2D results in topologically ordered PEPS [55], we leave for future works. Another interesting problem is the con- struction of parent Hamiltonians, possessing these PEPS as their unique ground states. ACKNOWLEDGEMENTS We thank Alberto Ruiz de Alarc´on for helpful dis- cussions and input at the beginning of the project. This research has been funded in part by the Eu- ropean Union’s Horizon 2020 research and innovation programme through Grant No. 863476 (ERC-CoG SE- QUAM). D.B. acknowledges funding by the FWF Quan- tum Austria Funding Initiative project “Entanglement Order Parameters” (10.55776/P36305), funded through the European Union (NextGenerationEU). J.G.R. ac- knowledges funding by the FWF Erwin Schr¨odinger Pro- gram (Grant No. J4796). E.Z. acknowledges funding by the European Union (ERC-CoG OverSign, 101122583). Views and opinions expressed are however those of the author(s) only and do not necessarily reﬂect those of the European Union or the European Research Council. Nei- ther the European Union nor the granting authority can be held responsible for them. 

--- Page 10 ---
10 Appendices A. GRAPHS Deﬁnition A.1 (Directed graph). A directed graph is an ordered pair Γ = (V, E) of sets V and E ⊆V × V . The elements of the set vert Γ := V are called vertices and the elements of the set edge Γ := E, which are ordered pairs of vertices, are called edges. For any edge e ≡(v1, v2) ∈E the vertex o(e) := v1 ∈V is called the origin of e and the vertex t(e) := v2 ∈V is called the terminus of e. For any vertex v ∈V let Eo v denote the set of edges that have v as their origin (i.e. the outgoing edges), Et v denote the set of edges that have v as their terminus (i.e. the incoming edges) and Ev denote the set of all adjacent edges. In formulas these sets are given as Eo v := {e ∈E | v = o(e)} , Et v := {e ∈E | v = t(e)} , Ev := Eo v ∪Et v. Deﬁnition A.2 (Oriented graph). A directed graph Γ for which (v1, v2) ∈edge Γ implies (v2, v1) /∈edge Γ, is called oriented graph. Deﬁnition A.3 (Subgraph). We say that the graph Γ′ is a subgraph of the graph Γ, denoted by Γ′ ⊆Γ, if vert Γ′ ⊆ vert Γ and edge Γ′ ⊆edge Γ. Subgraphs are said to be disjoint if their vertex sets are disjoint. Remark. Clearly any subgraph of an oriented graph will also be oriented. Given a graph Γ one can construct all subgraphs by taking subsets V ⊆vert Γ and E ⊆edge Γ satisfying o(e), t(e) ∈V for all e ∈E. Deﬁnition A.4 (Union of subgraphs). Let Γ1 = (V1, E1) and Γ2 = (V2, E2) be subgraphs of Γ. We deﬁne the union of Γ1 with Γ2 to be the subgraph Γ1 ∪Γ2 := (V1 ∪V2, E1 ∪E2) ⊆Γ. (56) Deﬁnition A.5 (Induced subgraph). A subgraph Γ′ ⊆ Γ is called induced or full if it contains all edges in Γ connecting vertices in vert Γ′. It is often denoted Γ[S], where S := vert Γ′ ⊆vert Γ. Deﬁnition A.6 (Boundary of a subgraph). Given a sub- graph Γ′ = (V ′, E′) ⊆Γ = (V, E), we deﬁne the internal, terminal and original boundaries of Γ′ (with respect to Γ) to be ∂iΓ′ := {e ∈E \ E′ | o(e) ∈V ′ ∧t(e) ∈V ′} , ∂tΓ′ := {e ∈E \ E′ | o(e) /∈V ′ ∧t(e) ∈V ′} , ∂oΓ′ := {e ∈E \ E′ | o(e) ∈V ′ ∧t(e) /∈V ′} , respectively. Deﬁnition A.7 (Bipartite graph). If the vertex set V of a graph Γ = (V, E) is the union of two disjoint subsets V = V1 ∪V2 and every edge in E connects a vertex in V1 with one in V2, then we say Γ is a bipartite graph and we commonly write Γ = (V1, V2, E). Deﬁnition A.8 (Subdivision). Let Γ = (V, E) be an oriented graph. The subdivision of Γ with respect to an edge e = (v1, v2) ∈E is an oriented graph Γe deﬁned by vert Γe := V ∪{e} (57) edge Γe := E ∪{(v1, e), (e, v2)} \ {e} . (58) Remark. Intuitively, we cut an edge in half and intro- duce a new vertex at the cut. The orientation of the new edges is induced from the original edge. The new edges eo := (v1, e) and et := (e, v2) can respectively be viewed as the ﬁrst and second half of what used to be the edge e. Pictorially: v1 v2 e 7−→ v1 v2 e eo et . (59) Deﬁnition A.9 (Barycentric subdivision). Subdividing every edge of a graph Γ yields a new graph Γb, called the barycentric subdivision of Γ. Remark. The barycentric subdivision of any graph Γ = (V, E) is bipartite and it is convenient to write Γb = (V, E, E), where E = [ e∈E  eo, et	 , et := (e, t(e)), eo := (o(e), e). (60) [1] M. E. Peskin and D. V. Schroeder, An Introduction to Quantum Field Theory (Addison-Wesley Pub. Co, Read- ing, Mass, 1995). [2] P. Langacker, The Standard Model and Beyond, Series in High Energy Physics, Cosmology and Gravitation (Tay- lor & Francis, 2011). [3] E. Fradkin, Field Theories of Condensed Matter Physics, Field Theories of Condensed Matter Physics (Cambridge University Press, 2013). [4] K. G. Wilson, Physical Review D 10, 2445 (1974). [5] M. Creutz, Quarks, Gluons and Lattices, Cambridge Monographs on Mathematical Physics (Cambridge Uni- versity Press, 1983). [6] S. Aoki, Y. Aoki, D. Becirevic, T. Blum, G. Colangelo, S. Collins, M. Della Morte, P. Dimopoulos, S. D¨urr, H. Fukaya, M. Golterman, S. Gottlieb, R. Gupta, S. Hashimoto, U. M. Heller, G. Herdoiza, R. Hors- ley, A. J¨uttner, T. Kaneko, C.-J. D. Lin, E. Lunghi, R. Mawhinney, A. Nicholson, T. Onogi, C. Pena, A. Portelli, A. Ramos, S. R. Sharpe, J. N. Simone, 

--- Page 11 ---
11 S. Simula, R. Sommer, R. Van de Water, A. Vladikas, U. Wenger, and H. Wittig, The European Physical Jour- nal C 80, 113 (2020). [7] M. Troyer and U.-J. Wiese, Physical Review Letters 94, 170201 (2005). [8] K. Fukushima and T. Hatsuda, Reports on Progress in Physics 74, 014001 (2011). [9] S. R. White, Phys. Rev. Lett. 69, 2863 (1992). [10] U. Schollw¨ock, Annals of Physics 326, 96–192 (2011). [11] D. Perez-Garcia, F. Verstraete, M. Wolf, and J. Cirac, Quant. Inf. Comput. 7, 401 (2007). [12] J. I. Cirac, D. P´erez-Garc´ıa, N. Schuch, and F. Ver- straete, Rev. Mod. Phys. 93, 045003 (2021). [13] M. B. Hastings, J. Stat. Mech. 2007, P08024–P08024 (2007). [14] M. B. Hastings, Physical Review B 76, 035114 (2007). [15] L. Masanes, Physical Review A 80, 052104 (2009). [16] J. Eisert, M. Cramer, and M. B. Plenio, Reviews of Mod- ern Physics 82, 277–306 (2010). [17] F. Verstraete and J. I. Cirac, Renormalization al- gorithms for quantum-many body systems in two and higher dimensions (2004), arXiv:cond-mat/0407066 [cond-mat.str-el]. [18] J. Kogut and L. Susskind, Physical Review D 11, 395 (1975). [19] M. Ba˜nuls, K. Cichy, J. Cirac, and K. Jansen, Journal of High Energy Physics 2013, 158 (2013). [20] B. Buyens, J. Haegeman, K. Van Acoleyen, H. Ver- schelde, and F. Verstraete, Physical Review Letters 113, 091601 (2014). [21] E. Rico, T. Pichler, M. Dalmonte, P. Zoller, and S. Mon- tangero, Physical Review Letters 112, 201601 (2014). [22] S. K¨uhn, E. Zohar, J. I. Cirac, and M. C. Ba˜nuls, Journal of High Energy Physics 2015, 130 (2015), arXiv:1505.04441. [23] M. C. Ba˜nuls, K. Cichy, J. I. Cirac, K. Jansen, and H. Saito, Physical Review D 92, 034519 (2015), arXiv:1505.00279 [hep-lat]. [24] T. Pichler, M. Dalmonte, E. Rico, P. Zoller, and S. Mon- tangero, Phys. Rev. X 6, 011023 (2016). [25] B. Buyens, F. Verstraete, and K. Van Acoleyen, Physical Review D 94, 085018 (2016). [26] M. Dalmonte and S. Montangero, Contemporary Physics 57, 388 (2016), arXiv:1602.03776. [27] M. C. Ba˜nuls, R. Blatt, J. Catani, A. Celi, J. I. Cirac, M. Dalmonte, L. Fallani, K. Jansen, M. Lewenstein, S. Montangero, C. A. Muschik, B. Reznik, E. Rico, L. Tagliacozzo, K. Van Acoleyen, F. Verstraete, U.-J. Wiese, M. Wingate, J. Zakrzewski, and P. Zoller, The European Physical Journal D 74, 165 (2020). [28] M. C. Ba˜nuls and K. Cichy, Reports on Progress in Physics 83, 024401 (2020). [29] L. Tagliacozzo and G. Vidal, Physical Review B 83, 115127 (2011). [30] L. Tagliacozzo, A. Celi, and M. Lewenstein, Phys. Rev. X 4, 041024 (2014). [31] S. P. G. Crone and P. Corboz, Physical Review B 101, 115143 (2020). [32] D. Robaina, M. C. Ba˜nuls, and J. I. Cirac, Physical Re- view Letters 126, 050401 (2021). [33] T. Felser, P. Silvi, M. Collura, and S. Montangero, Phys- ical Review X 10, 041040 (2020). [34] G. Magniﬁco, T. Felser, P. Silvi, and S. Montangero, Na- ture Communications 12, 3600 (2021). [35] S. Montangero, E. Rico, and P. Silvi, Phil. Trans. Roy. Soc. A 380, 20210065 (2022). [36] G. Cataldi, G. Magniﬁco, P. Silvi, and S. Montangero, (2+1)d su(2) yang-mills lattice gauge theory at ﬁnite den- sity via tensor networks (2024), arXiv:2307.09396 [hep- -lat]. [37] G. Magniﬁco, G. Cataldi, M. Rigobello, P. Majcen, D. Jaschke, P. Silvi, and S. Montangero, Tensor net- works for lattice gauge theories beyond one dimension: a roadmap (2024), arXiv:2407.03058 [hep-lat]. [38] Y. Meurice, R. Sakai, and J. Unmuth-Yockey, Reviews of Modern Physics 94, 025005 (2022). [39] J. Haegeman, K. V. Acoleyen, N. Schuch, J. I. Cirac, and F. Verstraete, Physical Review X 5, 011024 (2015). [40] E. Zohar and M. Burrello, New Journal of Physics 18, 043008 (2016). [41] C. V. Kraus, N. Schuch, F. Verstraete, and J. I. Cirac, Physical Review A 81, 052338 (2010). [42] E. Zohar, M. Burrello, T. B. Wahl, and J. I. Cirac, Annals of Physics 363, 385 (2015). [43] E. Zohar, T. B. Wahl, M. Burrello, and J. I. Cirac, Annals of Physics 374, 84 (2016). [44] E. Zohar and J. I. Cirac, Physical Review D 97, 034510 (2018). [45] P. Emonts, M. C. Ba˜nuls, I. Cirac, and E. Zohar, Physical Review D 102, 074501 (2020). [46] P. Emonts, A. Kelman, U. Borla, S. Moroz, S. Gazit, and E. Zohar, Phys. Rev. D 107, 014505 (2023). [47] A. Kelman, U. Borla, I. Gomelski, J. Elyovich, G. Roose, P. Emonts, and E. Zohar, Gauged gaussian peps – a high dimensional tensor network formulation for lattice gauge theories (2024), arXiv:2404.13123 [hep-lat]. [48] X. Chen, Z.-C. Gu, and X.-G. Wen, Physical Review B 84, 235128 (2011). [49] N. Schuch, D. P´erez-Garc´ıa, and I. Cirac, Physical Re- view B 84, 165139 (2011). [50] I. Kull, A. Molnar, E. Zohar, and J. I. Cirac, Annals of Physics 386, 199 (2017), arXiv:1708.00362. [51] A. Molnar, J. Garre-Rubio, D. P´erez-Garc´ıa, N. Schuch, and J. I. Cirac, New Journal of Physics 20, 113017 (2018), arXiv:1804.04964. [52] G. Scarpa, A. Moln´ar, Y. Ge, J. J. Garc´ıa-Ripoll, N. Schuch, D. P´erez-Garc´ıa, and S. Iblisdir, Phys. Rev. Lett. 125, 210504 (2020). [53] D. Perez-Garcia, F. Verstraete, J. I. Cirac, and M. M. Wolf, Peps as unique ground states of local hamiltonians (2008). [54] J.-P. Serre, Trees (Springer, 1980). [55] N. Schuch, I. Cirac, and D. P´erez-Garc´ıa, Annals of Physics 325, 2153 (2010). 

